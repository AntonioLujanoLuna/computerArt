<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Langton's Ant</title>
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/themes.css">
  <link rel="stylesheet" href="css/components/header.css">
  <link rel="stylesheet" href="css/components/card.css">
  <link rel="stylesheet" href="css/components/controls.css">
</head>
<body>
  <header>
    <a href="/" class="nav-link site-title"><h1>Agent Simulations Hub</h1></a>
    <nav id="main-nav">
      <a href="index.html" class="nav-link">Home</a>
      <a href="langton-ant.html" class="nav-link active">Langton's Ant</a>
      <a href="/game-of-life" class="nav-link">Game of Life</a>
      <!-- Additional navigation links -->
    </nav>
  </header>

  <main id="app">
    <!-- Langton's Ant Simulation View -->
    <div id="simulation-view" class="view">
      <canvas id="langtonCanvas"></canvas>
      <!-- <h2>Langton's Ant</h2> -->
      <div class="controls drag-handle"> <!-- Assuming your panel has 'drag-handle' for dragging -->
        <h2>Controls <span class="drag-indicator"></span></h2>
    
        <fieldset>
            <legend>Simulation Control</legend>
            <div>
                <button id="startButton">Start</button>
                <button id="stopButton">Stop</button>
                <button id="resetButton">Reset Simulation</button>
            </div>
            <div>
                <label for="speedSlider">Speed:</label>
                <input type="range" id="speedSlider" min="1" max="100" value="10">
            </div>
        </fieldset>
    
        <fieldset>
            <legend>Ant Configuration Editor</legend>
            <div>
                <label for="rulesTextarea">Ant Configuration (JSON):</label>
                <textarea id="rulesTextarea" rows="10" cols="40"></textarea>
            </div>
            <div>
                <button id="applyRulesButton">Apply Configuration from Editor</button>
                <button id="resetRulesButton">Load Default Single Ant to Editor & Apply</button>
            </div>
        </fieldset>
    
        <fieldset>
            <legend>Generate Ant Setups</legend>
            <p style="font-size: 0.9em; margin-top: 0; margin-bottom: 10px;"><em>Generates configurations and populates the editor above. Click "Apply Configuration from Editor" to use.</em></p>
            <div>
                <label for="numAntsForGeneration">Number of Ants:</label>
                <input type="number" id="numAntsForGeneration" value="1" min="1" style="width: 50px;">
            </div>
            <div>
                <label for="numStatesForRandom">Number of States for Ruleset(s):</label>
                <input type="number" id="numStatesForRandom" value="2" min="1" style="width: 50px;">
            </div>
            <div>
                <button id="generateAntsButton">Generate Ants (Unique Rulesets)</button>
                <br><small><em>Each ant gets its own new random ruleset.</em></small>
            </div>
            <div style="margin-top: 10px;">
                <button id="generateRulesButton">Generate Ants (Shared Ruleset)</button>
                <br><small><em>All ants get one new shared random ruleset.</em></small>
            </div>
        </fieldset>
    
        <fieldset>
            <legend>Visual Rule Editor</legend>
            <div>
                <label for="visualEditorAntSelector">Edit Rules for Ant:</label>
                <select id="visualEditorAntSelector">
                    <option value="">- Select Ant -</option> <!-- Default/placeholder -->
                </select>
            </div>
            <div id="visualRuleEditorCanvasContainer">
                <!-- Canvas for visual rule editor will go here -->
                <canvas id="visualRuleEditorCanvas"></canvas>
            </div>
            <div id="visualRuleEditorControls">
                <button id="addStateButton">Add State</button>
                <button id="removeStateButton">Remove State</button>
                <button id="applyVisualRulesButton" title="Apply rules from visual editor to simulation (updates textarea too)">Apply Visual Rules to Sim</button>
                <button id="getVisualRulesToJsonButton" title="Update main JSON textarea with rules from visual editor">Visual Editor &rarr; JSON Textarea</button>
                <button id="syncJsonViewButton" title="Open a dedicated JSON view/editor for the visual tool">Sync JSON View</button>
            </div>
            <div id="visualRuleEditorPropertiesPanel">
                <!-- Properties for selected states/transitions will be displayed here -->
                <p>Select a state or transition to see its properties.</p>
            </div>
        </fieldset>

        <fieldset>
            <legend>Visuals</legend>
            <div>
                <label for="paletteSelect">Cell Color Palette:</label>
                <select id="paletteSelect">
                    <option value="default">Default</option>
                    <option value="grayscale">Grayscale</option>
                    <option value="warm">Warm</option>
                    <option value="cool">Cool</option>
                    <option value="randomized">Randomized</option>
                </select>
            </div>
        </fieldset>
    </div>
  </main>

  <!-- Modal for JSON Sync View -->
  <div id="jsonSyncModal" class="modal">
    <div class="modal-content">
      <span class="close-button" id="closeJsonSyncModalButton">&times;</span>
      <h2>Visual Editor Rules - JSON View</h2>
      <textarea id="jsonSyncTextarea" rows="15" cols="60"></textarea>
      <div class="modal-actions">
        <button id="copyJsonToClipboardButton">Copy to Clipboard</button>
        <button id="applyJsonToVisualEditorButton">Apply JSON to Visual Editor</button>
        <!-- <button id="refreshJsonFromVisualEditorButton">Refresh from Visual Editor</button> -->
      </div>
    </div>
  </div>

  <footer>
    <p>Â© 2025 Agent Simulations Hub</p>
  </footer>

  <script type="module" src="js/simulations/langtonAnt/main.js"></script>
</body>
</html>